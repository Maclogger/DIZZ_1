<div class="card rounded-3 bg- col-4">
    <h3>@Headline</h3>
    @ChildContent

    <button @onclick="OnInitialize">Initialize Generator</button>
    <button @onclick="OnGenerate">Generate</button>

    <label>Count</label>
    <input @bind="CountToGenerate"/>

    <label>Generated values:</label>
    <textarea readonly>
        @GetPrintValuesForTextArea()
    </textarea>

</div>

@using DIZZ_1.BackEnd
@using DIZZ_1.BackEnd.Generators
@typeparam T

@code {
    [Parameter, EditorRequired] public string Headline { get; set; } = "";

    [Parameter, EditorRequired] public RenderFragment? ChildContent { get; set; }

    [Parameter, EditorRequired] public required Func<Generator<T>> Initialize { get; set; }

    [Parameter, EditorRequired] public required Generator<T>? Generator { get; set; }

    [Parameter] public int CountToGenerate { get; set; } = 1;

    private void OnGenerate()
    {
        if (Generator == null)
        {
            throw new ArgumentException("Generator was not initialized yet!");
        }

        for (int i = 0; i < CountToGenerate; i++)
        {
            Generator.Generate();
            /*
            Console.WriteLine($"Value: {value?.ToString()}");
            */
        }
    }

    private void OnInitialize()
    {
        Generator = Initialize();
    }

    private string GetPrintValuesForTextArea()
    {
        List<T> data = Generator?.Data ?? [];
        if (data.Count <= Config.MaxPrintValuesInTextArea)
        {
            return string.Join(", ", data);
        }

        IEnumerable<T> limitedValues = data.Take(Config.MaxPrintValuesInTextArea);
        return string.Join(", ", limitedValues) + "...";
    }
}